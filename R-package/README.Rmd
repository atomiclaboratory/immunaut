---
title: "immunaut"
author: "Ivan Tomic <info@ivantomic.com>"
output: github_document
vignette: >
  %VignetteIndexEntry{immunaut}
  %VignetteEngine{knitr::rmarkdown}
  usepackage[utf8]{inputenc}
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
Immunaut is an R package designed to facilitate machine learning analysis with multi-dimensional datasets. The codebase provides functions to perform dimensionality reduction, hierarchical clustering, and predictive modeling. Within this framework, users can use high-dimensional data, perform t-distributed stochastic neighbor embedding (t-SNE) for effective visualization and exploration, and then carry out hierarchical clustering to identify latent data structures. This analysis chain can then be extended by further appending the data with cluster results, allowing for the construction of machine learning models with specific outcomes. 

## Installation

You can install the released version of **immunaut** from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("immunaut")
```
Or you can install **immunaut** directly from **GitHub** with use of following commands:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("atomiclaboratory/immunaut", subdir = 'R-package')
```

## Initial setup
```{r example-setup, eval = TRUE}
library("immunaut")

dataset <- generate_demo_data(n_subjects = 1000, n_features = 200, 
                                desired_number_clusters = 3, 
                              cluster_overlap_sd = 100, 
                              missing_prob = 0.1)

# Generate file header from the demo data
file_header <- generate_file_header(dataset)

# Define settings for t-SNE and clustering
settings <- list(
  fileHeader = file_header,
  selectedColumns = colnames(dataset),
  
  excludedColumns = c("outcome", "age", "gender"),
  preProcessDataset = c("scale", "center", "medianImpute"),
  
  clusterType = "Louvain",  # Clustering method
  knn_clusters = 50,        # Number of neighbors for KNN in Louvain clustering
  
  pointSize = 2,           # Size of points in plots
  fontSize = 12,           # Font size for plots
  colorPalette = "RdPu"   # Color palette for plots
)

result <- immunaut(dataset, settings)

## Use inbuild function to plot clustered t-SNE using ggplot2
plotData <- plot_clustered_tsne(result$tsne_clust$info.norm, 
                                result$tsne_clust$cluster_data, 
                                result$settings)

print(plotData)

```

## Example 1: Perform t-SNE and Louvain Clustering
```{r example-1, message=FALSE, warning=FALSE}
# Set the clustering method to Louvain
settings$clusterType <- "Louvain"   
settings$knn_clusters <- 50         # Number of neighbors for KNN in Louvain clustering

# Perform t-SNE and Louvain clustering
result <- immunaut(dataset, settings)


dataset_ml <- result$dataset_filtered_with_clusters
# Remove excluded columns from dataset_ml
dataset_ml <- dataset_ml[, !colnames(dataset_ml) %in% settings$excludedColumns]
levels(dataset_ml[["pandora_cluster"]]) <- make.names(levels(dataset_ml[["pandora_cluster"]]))

unique(dataset_ml$pandora_cluster)

# Select machine learning algorithms and train models
selectedPackages <- c("nb", "rpart")
selectedPartitionSplit <- 0.7
# Run auto_simon_ml
model_results <- auto_simon_ml(dataset_ml, "pandora_cluster", selectedPackages, selectedPartitionSplit)







```

## Example 2: Switch to DBSCAN Clustering
```{r example-2, message=FALSE, warning=FALSE}
# Update settings for DBSCAN clustering
settings$clusterType <- "Density"
settings$minPtsAdjustmentFactor <- 1.5
settings$epsQuantile <- 0.9

# Run t-SNE and DBSCAN clustering
dbscan_result <- immunaut(immunautDemo, settings)

# Display the first few rows of the DBSCAN result
head(dbscan_result)

```

## Example 3: Perform Mclust Clustering
```{r example-3, message=FALSE, warning=FALSE}
# Update settings for Mclust clustering
settings$clusterType <- "Mclust"
settings$clustGroups <- 3  # Specify the number of clusters for Mclust

# Run t-SNE and Mclust clustering
mclust_result <- immunaut(immunautDemo, settings)

# Display the first few rows of the Mclust result
head(mclust_result)
```
